<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonic Quest: The Physics Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.5s ease;
        }

        .game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .story-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .problem-panel {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .character {
            font-size: 4rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .story-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .problem-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #FFD700;
        }

        .problem-description {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.5;
        }

        .formula-hint {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .btn {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
        }

        .feedback.correct {
            background: rgba(76, 175, 80, 0.3);
            border: 2px solid #4CAF50;
        }

        .feedback.incorrect {
            background: rgba(244, 67, 54, 0.3);
            border: 2px solid #f44336;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FFD700;
        }

        .victory-screen {
            display: none;
            text-align: center;
            background: rgba(255,255,255,0.15);
            padding: 40px;
            border-radius: 20px;
            margin-top: 30px;
        }

        .victory-screen.show {
            display: block;
        }

        .certificate-form {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .certificate-form h3 {
            margin-bottom: 15px;
            color: #FFD700;
        }

        .certificate-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .certificate-screen.show {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .certificate {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            max-width: 800px;
            width: 100%;
            margin: 20px auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-radius: 15px;
            overflow: hidden;
        }

        .certificate-border {
            border: 8px solid #FFD700;
            margin: 20px;
            border-radius: 10px;
            background: white;
            position: relative;
        }

        .certificate-border::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700, #FFA500);
            border-radius: 15px;
            z-index: -1;
        }

        .certificate-header {
            text-align: center;
            padding: 30px 20px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: -8px -8px 0 -8px;
        }

        .certificate-header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .certificate-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .certificate-body {
            padding: 40px 30px;
            text-align: center;
            line-height: 1.8;
        }

        .certificate-text {
            font-size: 1.1rem;
            margin: 10px 0;
            color: #555;
        }

        .student-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .class-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: #764ba2;
            margin: 15px 0;
        }

        .achievements {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .achievement {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .cert-stat {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #667eea;
        }

        .stat-label {
            display: block;
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
        }

        .cert-stat .stat-value {
            font-size: 1.3rem;
            color: #667eea;
        }

        .motivational-quote {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            font-style: italic;
            font-size: 1.1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-left: 5px solid #FF8C00;
        }

        .certificate-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .signature-line {
            text-align: center;
        }

        .signature {
            font-size: 1.3rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .title {
            color: #888;
            font-size: 0.9rem;
        }

        .certificate-actions {
            margin-top: 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .game-area {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .certificate {
                margin: 10px;
            }

            .student-name {
                font-size: 2rem;
            }

            .achievements {
                flex-direction: column;
                align-items: center;
            }

            .stats-section {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            .certificate-actions {
                display: none;
            }
            
            .certificate-screen {
                position: static;
                background: white;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>🎵 Harmonic Quest: The Physics Adventure 🎵</h1>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="currentLevel">1</div>
                <div>Level</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="score">0</div>
                <div>Score</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="attempts">3</div>
                <div>Attempts Left</div>
            </div>
        </div>

        <div class="game-area">
            <div class="story-panel">
                <div class="character" id="character">🧙‍♂️</div>
                <div class="story-text" id="storyText">
                    Welcome, young physicist! You've discovered an ancient laboratory where sound waves hold magical powers. To unlock each chamber, you must solve the mysteries of harmonic frequencies. Are you ready for this sonic adventure?
                </div>
            </div>

            <div class="problem-panel">
                <div class="problem-title" id="problemTitle">Chamber 1: The Vibrating String</div>
                <div class="problem-description" id="problemDescription">
                    You find a magical string stretched between two fixed points. The string is 0.8 meters long and the wave speed is 400 m/s. What is the frequency of the 3rd harmonic?
                </div>
                <div class="formula-hint" id="formulaHint">
                    String (both ends fixed): f_n = n × v / (2L)<br>
                    Where n = harmonic number, v = wave speed, L = length
                </div>
                
                <div class="input-group">
                    <label for="answer">Enter your answer (Hz):</label>
                    <input type="number" id="answer" step="0.01" placeholder="Enter frequency in Hz">
                </div>
                
                <button class="btn" onclick="checkAnswer()">Cast Frequency Spell! ✨</button>
                <button class="btn" onclick="showHint()" id="hintBtn">Need a Hint? 🔍</button>
                <button class="btn" onclick="generateNewProblem()" id="newProblemBtn">New Problem 🎲</button>
                
                <div class="feedback" id="feedback"></div>
            </div>
        </div>

        <div class="victory-screen" id="victoryScreen">
            <h2>🎉 Congratulations, Master of Harmonics! 🎉</h2>
            <p>You've successfully navigated through all the sonic chambers and mastered the art of harmonic frequencies!</p>
            <div class="stat-value" id="finalScore">Final Score: 0</div>
            
            <div class="certificate-form" id="certificateForm">
                <h3>🏆 Claim Your Certificate of Achievement! 🏆</h3>
                <div class="input-group">
                    <label for="studentName">Your Name:</label>
                    <input type="text" id="studentName" placeholder="Enter your full name">
                </div>
                <div class="input-group">
                    <label for="className">Class/Grade:</label>
                    <input type="text" id="className" placeholder="e.g., Physics 101, Grade 11">
                </div>
                <button class="btn" onclick="generateCertificate()">Generate Certificate 📜</button>
            </div>
            
            <button class="btn" onclick="restartGame()">Play Again 🔄</button>
        </div>

        <div class="victory-screen" id="gameOverScreen">
            <h2>💀 Game Over! 💀</h2>
            <p>You've run out of attempts, but don't give up! Physics mastery takes practice.</p>
            <div class="stat-value" id="gameOverScore">Final Score: 0</div>
            <div class="stat-value">Reached Level: <span id="gameOverLevel">1</span></div>
            <p style="margin-top: 20px; font-size: 1.1rem;">Keep practicing and you'll master those harmonic frequencies!</p>
            <button class="btn" onclick="restartGame()">Try Again 🔄</button>
        </div>

        <div class="certificate-screen" id="certificateScreen">
            <div class="certificate">
                <div class="certificate-border">
                    <div class="certificate-header">
                        <h1>🏆 CERTIFICATE OF ACHIEVEMENT 🏆</h1>
                        <div class="certificate-subtitle">Harmonic Quest: Physics Adventure</div>
                    </div>
                    
                    <div class="certificate-body">
                        <div class="certificate-text">This is to certify that</div>
                        <div class="student-name" id="certStudentName">Student Name</div>
                        <div class="certificate-text">from</div>
                        <div class="class-name" id="certClassName">Class Name</div>
                        <div class="certificate-text">has successfully completed the Harmonic Quest and demonstrated mastery of:</div>
                        
                        <div class="achievements">
                            <div class="achievement">✨ String Harmonic Frequencies</div>
                            <div class="achievement">🎺 Open Tube Resonance</div>
                            <div class="achievement">🎷 Closed Tube Harmonics</div>
                        </div>
                        
                        <div class="stats-section">
                            <div class="cert-stat">
                                <span class="stat-label">Final Score:</span>
                                <span class="stat-value" id="certScore">0</span>
                            </div>
                            <div class="cert-stat">
                                <span class="stat-label">Time Taken:</span>
                                <span class="stat-value" id="certTime">0:00</span>
                            </div>
                            <div class="cert-stat">
                                <span class="stat-label">Date:</span>
                                <span class="stat-value" id="certDate">Today</span>
                            </div>
                        </div>
                        
                        <div class="motivational-quote" id="motivationalQuote">
                            "The important thing is not to stop questioning. Curiosity has its own reason for existing." - Albert Einstein
                        </div>
                        
                        <div class="certificate-footer">
                            <div class="signature-line">
                                <div class="signature">Physics Adventure Academy</div>
                                <div class="title">Certified Physics Educator</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="certificate-actions">
                <button class="btn" onclick="printCertificate()">Print Certificate 🖨️</button>
                <button class="btn" onclick="closeCertificate()">Close Certificate ✖️</button>
                <button class="btn" onclick="restartGame()">Play Again 🔄</button>
            </div>
        </div>
    </div>

    <script>
        let currentLevel = 1;
        let score = 0;
        let attempts = 3;
        let maxLevel = 6;
        let startTime = Date.now();
        let gameCompleted = false;

        const levelTemplates = [
            {
                type: 'string',
                character: '🧙‍♂️',
                title: 'Chamber 1: The Vibrating String',
                story: 'You find a magical string stretched between two fixed points. The ancient runes glow as you approach...',
                formula: 'String (both ends fixed): f_n = n × v / (2L)',
                lengthRange: [0.3, 1.5],
                speedRange: [300, 500],
                harmonicRange: [1, 5]
            },
            {
                type: 'open_tube',
                character: '🎺',
                title: 'Chamber 2: The Open Wind Tunnel',
                story: 'A mystical wind tunnel appears, open at both ends. The air currents whisper ancient secrets...',
                formula: 'Open tube (both ends open): f_n = n × v / (2L)',
                lengthRange: [0.5, 2.5],
                speedRange: [330, 350],
                harmonicRange: [1, 4]
            },
            {
                type: 'closed_tube',
                character: '🎷',
                title: 'Chamber 3: The Sealed Echo Chamber',
                story: 'You discover a chamber sealed at one end, where echoes dance in mysterious patterns...',
                formula: 'Closed tube (one end closed): f_n = (2n-1) × v / (4L)',
                lengthRange: [0.4, 1.8],
                speedRange: [330, 350],
                harmonicRange: [1, 4]
            },
            {
                type: 'string',
                character: '🎻',
                title: 'Chamber 4: The Violin of Destiny',
                story: 'An enchanted violin string awaits your mastery. Its harmonics hold the key to the next chamber...',
                formula: 'String (both ends fixed): f_n = n × v / (2L)',
                lengthRange: [0.2, 0.8],
                speedRange: [400, 600],
                harmonicRange: [2, 6]
            },
            {
                type: 'open_tube',
                character: '🎺',
                title: 'Chamber 5: The Grand Organ Pipe',
                story: 'A magnificent organ pipe stands before you, its golden surface reflecting ancient knowledge...',
                formula: 'Open tube (both ends open): f_n = n × v / (2L)',
                lengthRange: [1.0, 3.0],
                speedRange: [340, 350],
                harmonicRange: [2, 5]
            },
            {
                type: 'closed_tube',
                character: '🏺',
                title: 'Chamber 6: The Final Resonance',
                story: 'The ultimate challenge awaits! A sacred vessel that resonates with the frequency of enlightenment...',
                formula: 'Closed tube (one end closed): f_n = (2n-1) × v / (4L)',
                lengthRange: [0.6, 2.0],
                speedRange: [340, 350],
                harmonicRange: [3, 6]
            }
        ];

        let levels = []; // Will be populated with generated problems

        function randomInRange(min, max, decimals = 2) {
            return parseFloat((Math.random() * (max - min) + min).toFixed(decimals));
        }

        function randomIntInRange(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateLevel(templateIndex) {
            const template = levelTemplates[templateIndex];
            const length = randomInRange(template.lengthRange[0], template.lengthRange[1]);
            const speed = randomIntInRange(template.speedRange[0], template.speedRange[1]);
            const harmonic = randomIntInRange(template.harmonicRange[0], template.harmonicRange[1]);
            
            let answer;
            let description;
            
            if (template.type === 'string' || template.type === 'open_tube') {
                answer = parseFloat((harmonic * speed / (2 * length)).toFixed(2));
            } else if (template.type === 'closed_tube') {
                answer = parseFloat(((2 * harmonic - 1) * speed / (4 * length)).toFixed(2));
            }
            
            // Generate description based on type
            if (template.type === 'string') {
                description = `A string is ${length} meters long with wave speed ${speed} m/s. Find the frequency of the ${getOrdinal(harmonic)} harmonic.`;
            } else if (template.type === 'open_tube') {
                description = `An open tube is ${length} meters long with sound speed ${speed} m/s. Find the frequency of the ${getOrdinal(harmonic)} harmonic.`;
            } else if (template.type === 'closed_tube') {
                description = `A closed tube is ${length} meters long with sound speed ${speed} m/s. Find the frequency of the ${getOrdinal(harmonic)} harmonic.`;
            }
            
            return {
                type: template.type,
                character: template.character,
                title: template.title,
                story: template.story,
                description: description,
                length: length,
                speed: speed,
                harmonic: harmonic,
                formula: template.formula,
                answer: answer
            };
        }

        function getOrdinal(num) {
            const ordinals = ['', '1st', '2nd', '3rd', '4th', '5th', '6th', '7th', '8th', '9th', '10th'];
            return ordinals[num] || `${num}th`;
        }

        function generateAllLevels() {
            levels = [];
            for (let i = 0; i < maxLevel; i++) {
                levels.push(generateLevel(i));
            }
        }

        function updateDisplay() {
            const level = levels[currentLevel - 1];
            document.getElementById('currentLevel').textContent = currentLevel;
            document.getElementById('score').textContent = score;
            document.getElementById('attempts').textContent = attempts;
            document.getElementById('progressFill').style.width = (currentLevel / maxLevel) * 100 + '%';
            
            document.getElementById('character').textContent = level.character;
            document.getElementById('problemTitle').textContent = level.title;
            document.getElementById('storyText').textContent = level.story;
            document.getElementById('problemDescription').textContent = level.description;
            document.getElementById('formulaHint').innerHTML = level.formula + '<br>Where n = harmonic number, v = wave speed, L = length';
            
            document.getElementById('answer').value = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
        }

        function checkAnswer() {
            const userAnswer = parseFloat(document.getElementById('answer').value);
            const level = levels[currentLevel - 1];
            const correctAnswer = level.answer;
            const tolerance = correctAnswer * 0.02; // 2% tolerance
            
            const feedback = document.getElementById('feedback');
            
            if (Math.abs(userAnswer - correctAnswer) <= tolerance) {
                feedback.textContent = `🎉 Correct! The frequency is ${correctAnswer.toFixed(2)} Hz. The chamber unlocks with a melodious chime!`;
                feedback.className = 'feedback correct';
                score += attempts * 100;
                
                setTimeout(() => {
                    if (currentLevel < maxLevel) {
                        currentLevel++;
                        attempts = 3;
                        updateDisplay();
                    } else {
                        showVictory();
                    }
                }, 2000);
            } else {
                attempts--;
                if (attempts > 0) {
                    feedback.textContent = `❌ Not quite right. You have ${attempts} attempts remaining. The correct answer is ${correctAnswer.toFixed(2)} Hz.`;
                    feedback.className = 'feedback incorrect';
                } else {
                    feedback.textContent = `💀 No attempts left! The correct answer was ${correctAnswer.toFixed(2)} Hz. Game Over!`;
                    feedback.className = 'feedback incorrect';
                    
                    setTimeout(() => {
                        showGameOver();
                    }, 3000);
                }
            }
            
            updateDisplay();
        }

        function showHint() {
            const level = levels[currentLevel - 1];
            let hint = '';
            
            if (level.type === 'string') {
                hint = `💡 Hint: Use f = ${level.harmonic} × ${level.speed} / (2 × ${level.length}). Calculate step by step!`;
            } else if (level.type === 'open_tube') {
                hint = `💡 Hint: Use f = ${level.harmonic} × ${level.speed} / (2 × ${level.length}). Same formula as strings!`;
            } else if (level.type === 'closed_tube') {
                hint = `💡 Hint: Use f = (2×${level.harmonic}-1) × ${level.speed} / (4 × ${level.length}). Note the (2n-1) factor!`;
            }
            
            document.getElementById('feedback').textContent = hint;
            document.getElementById('feedback').className = 'feedback';
        }

        function generateNewProblem() {
            // Generate a new problem for the current level
            levels[currentLevel - 1] = generateLevel(currentLevel - 1);
            attempts = 3; // Reset attempts for the new problem
            updateDisplay();
            
            const feedback = document.getElementById('feedback');
            feedback.textContent = '🎲 New problem generated! Good luck!';
            feedback.className = 'feedback';
        }

        function showVictory() {
            document.getElementById('finalScore').textContent = `Final Score: ${score}`;
            document.getElementById('victoryScreen').classList.add('show');
        }

        function showGameOver() {
            document.getElementById('gameOverScore').textContent = `Final Score: ${score}`;
            document.getElementById('gameOverLevel').textContent = currentLevel;
            document.getElementById('gameOverScreen').classList.add('show');
        }

        function generateCertificate() {
            const studentName = document.getElementById('studentName').value.trim();
            const className = document.getElementById('className').value.trim();
            
            if (!studentName || !className) {
                alert('Please enter both your name and class/grade!');
                return;
            }
            
            // Calculate time taken
            const endTime = Date.now();
            const timeTaken = Math.floor((endTime - startTime) / 1000);
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Get random motivational quote
            const quotes = [
                "The important thing is not to stop questioning. Curiosity has its own reason for existing. - Albert Einstein",
                "Science is not only a disciple of reason but also one of romance and passion. - Stephen Hawking",
                "The good thing about science is that it's true whether or not you believe in it. - Neil deGrasse Tyson",
                "Physics is like sex: sure, it may give some practical results, but that's not why we do it. - Richard Feynman",
                "In physics, you don't have to go around making trouble for yourself. Nature does it for you. - Frank Wilczek",
                "The universe is not only stranger than we imagine, it is stranger than we can imagine. - J.B.S. Haldane",
                "Physics is the universe's way of keeping track of itself. - Sean Carroll",
                "What we observe is not nature itself, but nature exposed to our method of questioning. - Werner Heisenberg",
                "The most beautiful thing we can experience is the mysterious. It is the source of all true art and science. - Albert Einstein",
                "Study hard what interests you the most in the most undisciplined, irreverent and original manner possible. - Richard Feynman"
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            
            // Update certificate content
            document.getElementById('certStudentName').textContent = studentName;
            document.getElementById('certClassName').textContent = className;
            document.getElementById('certScore').textContent = score;
            document.getElementById('certTime').textContent = timeString;
            document.getElementById('certDate').textContent = new Date().toLocaleDateString();
            document.getElementById('motivationalQuote').textContent = randomQuote;
            
            // Show certificate
            document.getElementById('certificateScreen').classList.add('show');
        }

        function printCertificate() {
            window.print();
        }

        function closeCertificate() {
            document.getElementById('certificateScreen').classList.remove('show');
        }

        function restartGame() {
            currentLevel = 1;
            score = 0;
            attempts = 3;
            startTime = Date.now();
            gameCompleted = false;
            document.getElementById('victoryScreen').classList.remove('show');
            document.getElementById('gameOverScreen').classList.remove('show');
            document.getElementById('certificateScreen').classList.remove('show');
            generateAllLevels(); // Generate new random problems
            updateDisplay();
        }

        // Handle Enter key press
        document.getElementById('answer').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Handle Enter key press in certificate form
        document.getElementById('studentName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('className').focus();
            }
        });

        document.getElementById('className').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateCertificate();
            }
        });

        // Initialize game
        generateAllLevels(); // Generate random problems for the first playthrough
        updateDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974d3ce2f5ac0c6d',t:'MTc1NjE0NzQzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
