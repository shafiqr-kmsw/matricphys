<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electrical Circuits Challenge</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    .circuit-icon {
      display: inline-block;
      font-size: 2em;
    }
    
    .pulse-correct {
      animation: pulseGreen 0.5s ease-in-out;
    }
    
    .pulse-incorrect {
      animation: pulseRed 0.5s ease-in-out;
    }
    
    @keyframes pulseGreen {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); background-color: #86efac; }
    }
    
    @keyframes pulseRed {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); background-color: #fca5a5; }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full w-full overflow-auto">
  <div id="app" class="h-full w-full"></div>
  <script>
    const defaultConfig = {
      background_color: "#1e293b",
      card_color: "#334155",
      text_color: "#f1f5f9",
      primary_button_color: "#3b82f6",
      secondary_button_color: "#10b981",
      font_family: "Inter",
      font_size: 16,
      game_title: "‚ö° Electrical Circuits Challenge",
      instructions_text: "Solve problems on Ohm's Law, resistivity, temperature effects, and circuit combinations!",
      check_button_text: "Check Answer",
      next_button_text: "Next Problem",
      restart_button_text: "Restart Game"
    };

    let currentProblem = 0;
    let score = 0;
    let answered = false;
    let playerName = "";
    let gameStarted = false;

    const questionBank = [
      // Ohm's Law Questions (8 questions)
      {
        type: "Ohm's Law",
        question: "A circuit has a voltage of 12V and a current of 3A. What is the resistance?",
        answer: 4,
        unit: "Œ©",
        formula: "R = V / I",
        icon: "üîã"
      },
      {
        type: "Ohm's Law",
        question: "A resistor of 10Œ© has a current of 2A flowing through it. What is the voltage?",
        answer: 20,
        unit: "V",
        formula: "V = I √ó R",
        icon: "‚ö°"
      },
      {
        type: "Ohm's Law",
        question: "A 15V battery is connected to a 5Œ© resistor. What current flows through it?",
        answer: 3,
        unit: "A",
        formula: "I = V / R",
        icon: "üîå"
      },
      {
        type: "Ohm's Law",
        question: "A circuit has 24V and resistance of 8Œ©. Calculate the current.",
        answer: 3,
        unit: "A",
        formula: "I = V / R",
        icon: "üîã"
      },
      {
        type: "Ohm's Law",
        question: "If 6A flows through a 4Œ© resistor, what is the voltage across it?",
        answer: 24,
        unit: "V",
        formula: "V = I √ó R",
        icon: "‚ö°"
      },
      {
        type: "Ohm's Law",
        question: "A voltage of 9V produces a current of 1.5A. What is the resistance?",
        answer: 6,
        unit: "Œ©",
        formula: "R = V / I",
        icon: "üîå"
      },
      {
        type: "Ohm's Law",
        question: "Calculate the current when 36V is applied across a 12Œ© resistor.",
        answer: 3,
        unit: "A",
        formula: "I = V / R",
        icon: "üîã"
      },
      {
        type: "Ohm's Law",
        question: "A 20Œ© resistor carries 0.5A. Find the voltage drop.",
        answer: 10,
        unit: "V",
        formula: "V = I √ó R",
        icon: "‚ö°"
      },
      
      // Resistivity Questions (6 questions)
      {
        type: "Resistivity",
        question: "A wire has length 2m, cross-sectional area 0.5mm¬≤ (5√ó10‚Åª‚Å∑ m¬≤), and resistivity 1.7√ó10‚Åª‚Å∏ Œ©m. Find resistance (round to 2 decimals).",
        answer: 0.07,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      {
        type: "Resistivity",
        question: "A copper wire (œÅ = 1.7√ó10‚Åª‚Å∏ Œ©m) has length 5m and area 1mm¬≤ (1√ó10‚Åª‚Å∂ m¬≤). Calculate resistance (round to 2 decimals).",
        answer: 0.09,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      {
        type: "Resistivity",
        question: "A wire with resistivity 2.8√ó10‚Åª‚Å∏ Œ©m, length 3m, and area 0.8mm¬≤ (8√ó10‚Åª‚Å∑ m¬≤) has what resistance? (round to 2 decimals)",
        answer: 0.11,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      {
        type: "Resistivity",
        question: "An aluminum wire (œÅ = 2.82√ó10‚Åª‚Å∏ Œ©m) of 10m length and 2mm¬≤ area has resistance? (round to 2 decimals)",
        answer: 0.14,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      {
        type: "Resistivity",
        question: "A wire (œÅ = 5√ó10‚Åª‚Å∏ Œ©m) with 1m length and 0.5mm¬≤ area has what resistance? (round to 2 decimals)",
        answer: 0.10,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      {
        type: "Resistivity",
        question: "Find resistance of a 4m wire with œÅ = 1.5√ó10‚Åª‚Å∏ Œ©m and area 1.2mm¬≤ (1.2√ó10‚Åª‚Å∂ m¬≤). (round to 2 decimals)",
        answer: 0.05,
        unit: "Œ©",
        formula: "R = œÅL / A",
        icon: "üìè"
      },
      
      // Temperature Coefficient Questions (6 questions)
      {
        type: "Temperature",
        question: "A resistor has resistance 100Œ© at 20¬∞C. With temperature coefficient 0.004/¬∞C, what is resistance at 70¬∞C?",
        answer: 120,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 +     ‚àÜT)",
        icon: "üå°Ô∏è"
      },
      {
        type: "Temperature",
        question: "A copper wire (Œ± = 0.0039/¬∞C) has 50Œ© at 25¬∞C. Find resistance at 125¬∞C (round to nearest integer).",
        answer: 70,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 + Œ±‚àÜT)",
        icon: "üî•"
      },
      {
        type: "Temperature",
        question: "A resistor (Œ± = 0.005/¬∞C) measures 80Œ© at 30¬∞C. What is its resistance at 80¬∞C?",
        answer: 100,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 + Œ±‚àÜT)",
        icon: "üå°Ô∏è"
      },
      {
        type: "Temperature",
        question: "An aluminum wire (Œ± = 0.0043/¬∞C) has 40Œ© at 0¬∞C. Find resistance at 100¬∞C.",
        answer: 57,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 + Œ±‚àÜT)",
        icon: "üî•"
      },
      {
        type: "Temperature",
        question: "A resistor with Œ± = 0.003/¬∞C has 200Œ© at 20¬∞C. Calculate resistance at 120¬∞C.",
        answer: 260,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 + Œ±‚àÜT)",
        icon: "üå°Ô∏è"
      },
      {
        type: "Temperature",
        question: "A wire (Œ± = 0.0040/¬∞C) shows 60Œ© at 15¬∞C. What is resistance at 65¬∞C?",
        answer: 72,
        unit: "Œ©",
        formula: "R‚ÇÇ = R‚ÇÅ(1 + Œ±‚àÜT)",
        icon: "üî•"
      },
      
      // Series Circuit Questions (5 questions)
      {
        type: "Series Circuit",
        question: "Three resistors (5Œ©, 10Œ©, 15Œ©) are connected in series. What is the total resistance?",
        answer: 30,
        unit: "Œ©",
        formula: "R_total = R‚ÇÅ + R‚ÇÇ + R‚ÇÉ",
        icon: "‚û°Ô∏è"
      },
      {
        type: "Series Circuit",
        question: "Four 8Œ© resistors are connected in series. What is the total resistance?",
        answer: 32,
        unit: "Œ©",
        formula: "R_total = R‚ÇÅ + R‚ÇÇ + R‚ÇÉ + R‚ÇÑ",
        icon: "  "
      },
      {
        type: "Series Circuit",
        question: "Two resistors (12Œ© and 18Œ©) are in series. Find total resistance.",
        answer: 30,
        unit: "Œ©",
        formula: "R_total = R‚ÇÅ + R‚ÇÇ",
        icon: "‚û°Ô∏è"
      },
      {
        type: "Series Circuit",
        question: "Five 6Œ© resistors are connected in series. Calculate total resistance.",
        answer: 30,
        unit: "Œ©",
        formula: "R_total = R‚ÇÅ + R‚ÇÇ + R‚ÇÉ + R‚ÇÑ + R‚ÇÖ",
        icon: "üîó"
      },
      {
        type: "Series Circuit",
        question: "Three resistors (20Œ©, 30Œ©, 50Œ©) in series. What is R_total?",
        answer: 100,
        unit: "Œ©",
        formula: "R_total = R‚ÇÅ + R‚ÇÇ + R‚ÇÉ",
        icon: "‚û°Ô∏è"
      },
      
      // Parallel Circuit Questions (5 questions)
      {
        type: "Parallel Circuit",
        question: "Two resistors (6Œ© and 12Œ©) are connected in parallel. What is the total resistance?",
        answer: 4,
        unit: "Œ©",
        formula: "1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ",
        icon: "‚¨áÔ∏è"
      },
      {
        type: "Parallel Circuit",
        question: "Three 9Œ© resistors are connected in parallel. What is the total resistance?",
        answer: 3,
        unit: "Œ©",
        formula: "1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ + 1/R‚ÇÉ",
        icon: "‚ö°"
      },
      {
        type: "Parallel Circuit",
        question: "Two 10Œ© resistors in parallel. Calculate total resistance.",
        answer: 5,
        unit: "Œ©",
        formula: "1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ",
        icon: "‚¨áÔ∏è"
      },
      {
        type: "Parallel Circuit",
        question: "Three resistors (6Œ©, 6Œ©, 6Œ©) are in parallel. Find R_total.",
        answer: 2,
        unit: "Œ©",
        formula: "1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ + 1/R‚ÇÉ",
        icon: "‚ö°"
      },
      {
        type: "Parallel Circuit",
        question: "Two resistors (4Œ© and 12Œ©) in parallel. What is total resistance?",
        answer: 3,
        unit: "Œ©",
        formula: "1/R_total = 1/R‚ÇÅ + 1/R‚ÇÇ",
        icon: "‚¨áÔ∏è"
      }
    ];

    let selectedProblems = [];

    function selectRandomProblems() {
      const shuffled = [...questionBank].sort(() => Math.random() - 0.5);
      selectedProblems = shuffled.slice(0, 10);
      currentProblem = 0;
      score = 0;
      answered = false;
    }

    // Initialize on first load
    selectRandomProblems();

    function renderApp(config) {
      const app = document.getElementById('app');
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;
      
      // Welcome screen - ask for name
      if (!gameStarted) {
        app.innerHTML = `
          <div style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack}; min-height: 100%; padding: 2rem; display: flex; align-items: center; justify-content: center;">
            <div style="background: ${config.card_color || defaultConfig.card_color}; border-radius: 1rem; padding: 3rem; max-width: 500px; width: 100%; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); text-align: center;">
              <div style="font-size: ${baseSize * 4}px; margin-bottom: 1.5rem;">‚ö°</div>
              <h1 style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 2}px; font-weight: bold; margin-bottom: 1rem;">
                ${config.game_title || defaultConfig.game_title}
              </h1>
              <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; margin-bottom: 2rem; opacity: 0.8;">
                ${config.instructions_text || defaultConfig.instructions_text}
              </p>
              <div style="margin-bottom: 2rem;">
                <label for="nameInput" style="display: block; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; font-weight: 600; margin-bottom: 0.5rem;">Enter Your Name</label>
                <input 
                  type="text" 
                  id="nameInput" 
                  placeholder="Your name"
                  style="width: 100%; padding: 0.875rem; border: 2px solid rgba(255,255,255,0.2); border-radius: 0.5rem; background: rgba(0,0,0,0.3); color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; outline: none; text-align: center;"
                />
              </div>
              <button 
                id="startBtn" 
                style="background: ${config.primary_button_color || defaultConfig.primary_button_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; padding: 1rem 2rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; transition: all 0.2s; width: 100%;"
              >
                Start Challenge
              </button>
            </div>
          </div>
        `;
        
        const nameInput = document.getElementById('nameInput');
        const startBtn = document.getElementById('startBtn');
        
        nameInput.focus();
        
        startBtn.addEventListener('mouseenter', () => {
          startBtn.style.transform = 'scale(1.02)';
          startBtn.style.opacity = '0.9';
        });
        startBtn.addEventListener('mouseleave', () => {
          startBtn.style.transform = 'scale(1)';
          startBtn.style.opacity = '1';
        });
        
        startBtn.addEventListener('click', () => {
          const name = nameInput.value.trim();
          if (name) {
            playerName = name;
            gameStarted = true;
            renderApp(config);
          } else {
            nameInput.style.borderColor = '#ef4444';
            setTimeout(() => {
              nameInput.style.borderColor = 'rgba(255,255,255,0.2)';
            }, 1000);
          }
        });
        
        nameInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            startBtn.click();
          }
        });
        
        return;
      }
      
      if (currentProblem >= selectedProblems.length) {
        const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        const percentage = Math.round((score / selectedProblems.length) * 100);
        
        app.innerHTML = `
          <div style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack}; min-height: 100%; padding: 2rem; display: flex; align-items: center; justify-content: center;">
            <div style="max-width: 700px; width: 100%;">
              <!-- Certificate -->
              <div style="background: linear-gradient(135deg, ${config.card_color || defaultConfig.card_color} 0%, ${config.background_color || defaultConfig.background_color} 100%); border: 8px solid ${config.primary_button_color || defaultConfig.primary_button_color}; border-radius: 1.5rem; padding: 3rem; margin-bottom: 2rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); position: relative; overflow: hidden;">
                <!-- Decorative corners -->
                <div style="position: absolute; top: 1rem; left: 1rem; font-size: ${baseSize * 2}px; opacity: 0.3;">‚ö°</div>
                <div style="position: absolute; top: 1rem; right: 1rem; font-size: ${baseSize * 2}px; opacity: 0.3;">‚ö°</div>
                <div style="position: absolute; bottom: 1rem; left: 1rem; font-size: ${baseSize * 2}px; opacity: 0.3;">üîã</div>
                <div style="position: absolute; bottom: 1rem; right: 1rem; font-size: ${baseSize * 2}px; opacity: 0.3;">üîã</div>
                
                <div style="text-align: center; position: relative; z-index: 1;">
                  <div style="font-size: ${baseSize * 4}px; margin-bottom: 1rem;">üèÜ</div>
                  <h1 style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 2}px; font-weight: bold; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.1em;">Certificate of Achievement</h1>
                  <div style="width: 60px; height: 3px; background: ${config.secondary_button_color || defaultConfig.secondary_button_color}; margin: 1rem auto;"></div>
                  
                  <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px; margin-bottom: 1.5rem; opacity: 0.8;">This certifies that</p>
                  
                  <h2 style="color: ${config.secondary_button_color || defaultConfig.secondary_button_color}; font-size: ${baseSize * 2.5}px; font-weight: bold; margin-bottom: 1.5rem; font-style: italic;">${playerName}</h2>
                  
                  <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px; margin-bottom: 1rem; opacity: 0.8;">has successfully completed</p>
                  
                  <h3 style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 1.5}px; font-weight: bold; margin-bottom: 2rem;">‚ö° Electrical Circuits Challenge ‚ö°</h3>
                  
                  <div style="background: rgba(59, 130, 246, 0.2); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 2rem;">
                    <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 1.25}px; font-weight: bold; margin-bottom: 0.5rem;">Score: ${score} / ${selectedProblems.length}</p>
                    <p style="color: ${config.secondary_button_color || defaultConfig.secondary_button_color}; font-size: ${baseSize * 1.75}px; font-weight: bold;">${percentage}% Mastery</p>
                  </div>
                  
                  <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 1.1}px; margin-bottom: 0.5rem; opacity: 0.9;">
                    ${score === selectedProblems.length ? "Perfect Score! You're an electrical circuits master! ‚ö°" : 
                      score >= selectedProblems.length * 0.7 ? "Great Job! You have a solid understanding! üëè" :
                      "Well Done! You're making great progress! üí™"}
                  </p>
                  
                  <div style="width: 60px; height: 3px; background: ${config.secondary_button_color || defaultConfig.secondary_button_color}; margin: 1.5rem auto;"></div>
                  
                  <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.8}px; opacity: 0.7;">${today}</p>
                </div>
              </div>
              
              <!-- Restart Button -->
              <div style="text-align: center;">
                <button id="restartBtn" style="background: ${config.primary_button_color || defaultConfig.primary_button_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; padding: 1rem 2.5rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                  ${config.restart_button_text || defaultConfig.restart_button_text}
                </button>
              </div>
            </div>
          </div>
        `;
        
        const restartBtn = document.getElementById('restartBtn');
        restartBtn.addEventListener('mouseenter', () => {
          restartBtn.style.transform = 'scale(1.05)';
          restartBtn.style.opacity = '0.9';
        });
        restartBtn.addEventListener('mouseleave', () => {
          restartBtn.style.transform = 'scale(1)';
          restartBtn.style.opacity = '1';
        });
        restartBtn.addEventListener('click', () => {
          gameStarted = false;
          playerName = "";
          selectRandomProblems();
          renderApp(config);
        });
        return;
      }

      const problem = selectedProblems[currentProblem];
      
      app.innerHTML = `
        <div style="background: ${config.background_color || defaultConfig.background_color}; font-family: ${customFont}, ${baseFontStack}; min-height: 100%; padding: 2rem;">
          <div style="max-width: 800px; margin: 0 auto;">
            <header style="text-align: center; margin-bottom: 2rem;">
              <h1 style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 2}px; font-weight: bold; margin-bottom: 0.5rem;">
                ${config.game_title || defaultConfig.game_title}
              </h1>
              <p style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; opacity: 0.8;">
                ${config.instructions_text || defaultConfig.instructions_text}
              </p>
            </header>

            <div style="background: ${config.card_color || defaultConfig.card_color}; border-radius: 1rem; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
                <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px; opacity: 0.8;">
                  Problem ${currentProblem + 1} of ${selectedProblems.length}
                </div>
                <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px; font-weight: 600;">
                  Score: ${score} / ${selectedProblems.length}
                </div>
              </div>

              <div style="background: rgba(59, 130, 246, 0.1); border-left: 4px solid ${config.primary_button_color || defaultConfig.primary_button_color}; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                <div style="color: ${config.primary_button_color || defaultConfig.primary_button_color}; font-size: ${baseSize * 0.85}px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;">
                  ${problem.type}
                </div>
              </div>

              <div style="text-align: center; font-size: ${baseSize * 3}px; margin-bottom: 1.5rem;">
                ${problem.icon}
              </div>

              <div style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 1.125}px; margin-bottom: 2rem; line-height: 1.6;">
                ${problem.question}
              </div>

              <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; align-items: center;">
                <label for="answer" style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; font-weight: 600;">Your Answer:</label>
                <input 
                  type="number" 
                  id="answer" 
                  step="0.01"
                  style="flex: 1; padding: 0.75rem; border: 2px solid rgba(255,255,255,0.2); border-radius: 0.5rem; background: rgba(0,0,0,0.3); color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; outline: none;"
                  ${answered ? 'disabled' : ''}
                />
                <span style="color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; font-weight: 600;">
                  ${problem.unit}
                </span>
              </div>

              <div id="feedback" style="margin-bottom: 1.5rem; min-height: 3rem;"></div>

              <div style="display: flex; gap: 1rem; justify-content: center;">
                <button 
                  id="checkBtn" 
                  style="background: ${config.primary_button_color || defaultConfig.primary_button_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; padding: 0.875rem 2rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; transition: all 0.2s; ${answered ? 'opacity: 0.5; cursor: not-allowed;' : ''}"
                  ${answered ? 'disabled' : ''}
                >
                  ${config.check_button_text || defaultConfig.check_button_text}
                </button>
                <button 
                  id="nextBtn" 
                  style="background: ${config.secondary_button_color || defaultConfig.secondary_button_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize}px; padding: 0.875rem 2rem; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 600; transition: all 0.2s; ${!answered ? 'opacity: 0.5; cursor: not-allowed;' : ''}"
                  ${!answered ? 'disabled' : ''}
                >
                  ${config.next_button_text || defaultConfig.next_button_text}
                </button>
              </div>
            </div>
          </div>
        </div>
      `;

      const answerInput = document.getElementById('answer');
      const checkBtn = document.getElementById('checkBtn');
      const nextBtn = document.getElementById('nextBtn');
      const feedback = document.getElementById('feedback');

      if (!answered) {
        answerInput.focus();
      }

      checkBtn.addEventListener('mouseenter', () => {
        if (!answered) {
          checkBtn.style.transform = 'scale(1.05)';
          checkBtn.style.opacity = '0.9';
        }
      });
      checkBtn.addEventListener('mouseleave', () => {
        if (!answered) {
          checkBtn.style.transform = 'scale(1)';
          checkBtn.style.opacity = '1';
        }
      });

      nextBtn.addEventListener('mouseenter', () => {
        if (answered) {
          nextBtn.style.transform = 'scale(1.05)';
          nextBtn.style.opacity = '0.9';
        }
      });
      nextBtn.addEventListener('mouseleave', () => {
        if (answered) {
          nextBtn.style.transform = 'scale(1)';
          nextBtn.style.opacity = '1';
        }
      });

      checkBtn.addEventListener('click', () => {
        if (answered) return;
        
        const userAnswer = parseFloat(answerInput.value);
        if (isNaN(userAnswer)) {
          feedback.innerHTML = `<div style="background: rgba(251, 146, 60, 0.2); border-left: 4px solid #fb923c; padding: 1rem; border-radius: 0.5rem; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px;">‚ö†Ô∏è Please enter a valid number</div>`;
          return;
        }

        const isCorrect = Math.abs(userAnswer - problem.answer) < 0.1;
        answered = true;

        if (isCorrect) {
          score++;
          feedback.innerHTML = `<div class="pulse-correct" style="background: rgba(134, 239, 172, 0.2); border-left: 4px solid #86efac; padding: 1rem; border-radius: 0.5rem; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px;">‚úÖ Correct! Well done!</div>`;
        } else {
          feedback.innerHTML = `<div class="pulse-incorrect" style="background: rgba(252, 165, 165, 0.2); border-left: 4px solid #fca5a5; padding: 1rem; border-radius: 0.5rem; color: ${config.text_color || defaultConfig.text_color}; font-size: ${baseSize * 0.9}px;">‚ùå Incorrect. The correct answer is ${problem.answer} ${problem.unit}</div>`;
        }

        checkBtn.disabled = true;
        checkBtn.style.opacity = '0.5';
        checkBtn.style.cursor = 'not-allowed';
        answerInput.disabled = true;
        
        nextBtn.disabled = false;
        nextBtn.style.opacity = '1';
        nextBtn.style.cursor = 'pointer';
      });

      nextBtn.addEventListener('click', () => {
        if (!answered) return;
        currentProblem++;
        answered = false;
        renderApp(config);
      });

      answerInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !answered) {
          checkBtn.click();
        }
      });
    }

    async function onConfigChange(config) {
      renderApp(config);
    }

    async function initializeApp() {
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.card_color || defaultConfig.card_color,
                set: (value) => {
                  config.card_color = value;
                  window.elementSdk.setConfig({ card_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.primary_button_color || defaultConfig.primary_button_color,
                set: (value) => {
                  config.primary_button_color = value;
                  window.elementSdk.setConfig({ primary_button_color: value });
                }
              },
              {
                get: () => config.secondary_button_color || defaultConfig.secondary_button_color,
                set: (value) => {
                  config.secondary_button_color = value;
                  window.elementSdk.setConfig({ secondary_button_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["game_title", config.game_title || defaultConfig.game_title],
            ["instructions_text", config.instructions_text || defaultConfig.instructions_text],
            ["check_button_text", config.check_button_text || defaultConfig.check_button_text],
            ["next_button_text", config.next_button_text || defaultConfig.next_button_text],
            ["restart_button_text", config.restart_button_text || defaultConfig.restart_button_text]
          ])
        });

        await onConfigChange(window.elementSdk.config);
      } else {
        // Render with default config if SDK not available
        renderApp(defaultConfig);
      }
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ace476e252f473c',t:'MTc2NTU1MzU5NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>